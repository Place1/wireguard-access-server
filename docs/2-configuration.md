# Configuration

You can configure wg-access-server using environment variables, cli flags or a config file
taking precedence over one another in that order.

The default configuration should work out of the box if you're just looking to try it out.![dark-settings-ipad-29pt](https://github.com/user-attachments/assets/be281abf-37d4-40b2-be9f-2d5b074d365a)
![dark-spotlight-iphone-40pt@2x](https://github.com/user-attachments/assets/18762ac0-3c16-4759-a5b8-3f5461e35f59)
![dark-spotlight-iphone-40pt@3x](https://github.com/user-attachments/assets/39b7a530-8bc5-4e88-bf06-eb90573f6b12)
![dark-spotlight-ipad-40pt@2x](https://github.com/user-attachments/assets/cd0a7037-9c48-4b65-9af7-0f4d9320433f)
![dark-notification-iphone-20pt@2x](https://github.com/user-attachments/assets/c8dbbc4a-d0a7-4c27-a6a6-dd427c913c15)
![dark-settings-iphone-29pt@3x](https://github.com/user-attachments/assets/19279d2d-d3cf-481e-aaa2-9a7e83ac14a9)
![dark-spotlight-ipad-40pt](https://github.com/user-attachments/assets/4021f39c-c0c6-4bff-bb4f-98c8c1e138dd)
![dark-notification-ipad-20pt@2x](https://github.com/user-attachments/assets/f7ccff05-6bc0-4e6c-b721-3b70b985d244)
![dark-settings-iphone-29pt@2x](https://github.com/user-attachments/assets/362b03ae-f184-431b-b04c-484172d77e8e)
![dark-app-iphone-60pt@3x](https://github.com/user-attachments/assets/310f01ae-14e4-4944-8889-b5355a897b44)
![dark-settings-ipad-29pt@2x](https://github.com/user-attachments/assets/585a2cd4-6870-452f-86e1-014634977e9a)
![dark-notification-iphone-20pt@3x](https://github.com/user-attachments/assets/5e63040c-83a9-4628-a50f-5a781b24cffd)
![dark-app-ipad-76pt](https://github.com/user-attachments/assets/22739207-c1dd-4392-99d8-0adef63219b8)
![dark-app-ipad-76pt@2x](https://github.com/user-attachments/assets/930b2024-10b3-49f9-970a-8e2fd0c5a15a)
![dark-notification-ipad-20pt](https://github.com/user-attachments/assets/0b1074eb-8d51-4091-aaa8-45875bb0e2e1)
![dark-app-iphone-60pt@2x](https://github.com/user-attachments/assets/b531c601-4847-4205-8764-7bb591895179)
<img width="1052" alt="iso-grid-ipad-light@2x" src="https://github.com/user-attachments/assets/1c762993-bcc8-4daa-bb7a-44d2ed031b20">
![dark-app-ipad-pro-83 5pt@2x](https://github.com/user-attachments/assets/8fa68315-ac08-4d9f-9692-342a2fea4d09)
![blink](https://github.com/user-attachments/assets/a091242b-f29a-4352-be68-1f866bb5d0fc)
![iso-grid-iphone-dark@3x](https://github.com/user-attachments/assets/abcc155f-b210-4a4b-bcd2-86236fd7bdcd)
![iso-grid-iphone-light](https://github.com/user-attachments/assets/e97fb31b-84df-46f3-8475-9a2a559ea94f)
<img width="470" alt="iso-grid-iphone-dark@2x" src="https://github.com/user-attachments/assets/d5e1cee8-1313-4eed-8ce8-636adfe57ece">
![lock-unlocked@2x](https://github.com/user-attachments/assets/7b46640a-90cc-44a7-817e-d07ad49e9a56)
![iso-grid-ipad-light](https://github.com/user-attachments/assets/ee21edf4-cf05-4f7e-bc23-20814bef2669)
![lock-unlocked](https://github.com/user-attachments/assets/d6e05c9c-b981-4f39-883c-ada8b22026f1)
![iso-grid-ipad-dark](https://github.com/user-attachments/assets/d1bc98c9-f809-4590-bda7-36e9ceb45aeb)
![lock-unlocked@3x](https://github.com/user-attachments/assets/e17ca0f3-2dbe-41a4-9532-8d9cce226cac)
<img width="470" alt="iso-grid-iphone-light@2x" src="https://github.com/user-attachments/assets/145e5d93-a8c8-4b1a-a95a-f67f70493dca">
![iPhone-Spotlight-40pt@3x](https://github.com/user-attachments/assets/b32c4a1f-7781-46af-80cb-2d529daff2cf)
![iso-grid-iphone-light@3x](https://github.com/user-attachments/assets/694d0f5c-d2c1-4361-bae8-caa71ca8da7f)
![iPhone-Settings-29pt@2x](https://github.com/user-attachments/assets/9814a054-46bd-4500-8053-dd66b9ecacfa)
![iso-grid-iphone-dark](https://github.com/user-attachments/assets/09ae9c80-dddb-45fc-a8e8-e1a0f8def3ad)
<img width="1052" alt="iso-grid-ipad-dark@2x" src="https://github.com/user-attachments/assets/17759397-8e7e-4c7e-b355-431e818552ea">
![iPhone-Settings-29pt@3x](https://github.com/user-attachments/assets/26ac8c42-d011-4105-bbeb-c325762590d7)
![iPhone-Spotlight-40pt@2x](https://github.com/user-attachments/assets/5d3ad865-4a03-43b7-bcc8-2f8d5ed0e1c3)
![iPhone-Settings-29pt](https://github.com/user-attachments/assets/63e2b3df-30eb-41de-8aec-ed76eae68465)
![iPhone-Notification-20pt@3x](https://github.com/user-attachments/assets/0c97cc2f-9341-43fe-93fb-b5bbc6067246)
![iPhone-Notification-20pt@2x](https://github.com/user-attachments/assets/2b220baa-f32f-4cfe-8137-22f580d2db6c)
![build-logo-iphone-light](https://github.com/user-attachments/assets/d73b5237-85f5-4fcd-9d6a-3c7b92a5ceab)
![iPad-Pro-App-83 5pt@2x](https://github.com/user-attachments/assets/8a989a6d-c979-409a-9588-592192030907)
![iPad-Settings-29pt@2x](https://github.com/user-attachments/assets/b2dc1338-bf1d-4408-b7e1-d9d9b0366a28)
![iPad-Settings-29pt](https://github.com/user-attachments/assets/ba5dff8f-1743-45bb-bb5e-d09487a51029)
<img width="163" alt="build-logo-iphone-light@2x" src="https://github.com/user-attachments/assets/d7a7886f-4088-420b-a09d-94ef898fa911">
![iPad-App-76pt@2x](https://github.com/user-attachments/assets/27e5dec4-3624-4c23-b2ee-f1e913cb4d62)
![iPad-Notification-20pt@2x](https://github.com/user-attachments/assets/36cdd766-fc85-4a67-af63-f05573de5fa8)
![IMG_C584F1592DE7-1](https://github.com/user-attachments/assets/36e29eb3-0d3e-4a07-bf03-956d2e64704a)
![iPad-Notification-20pt](https://github.com/user-attachments/assets/2693309e-200a-4d1a-a858-74c377bce33c)
![build-logo-ipad-light](https://github.com/user-attachments/assets/32019206-ffc3-4498-bb9a-2c89049e9f80)
![lock-locked@3x](https://github.com/user-attachments/assets/e025d62d-4766-4a37-b449-e42b4e077bf3)
![iPhone-App-60pt@3x](https://github.com/user-attachments/assets/7b36aed4-b8f2-44db-9f72-8f877e85e82f)
![iPad-App-76pt](https://github.com/user-attachments/assets/223ac373-d82a-4270-b0c3-1db18dd3a26a)
![build-logo-iphone-light@3x](https://github.com/user-attachments/assets/9cb79ff0-5f76-4caf-91c5-51e2ed8050a3)
<img width="264" alt="build-logo-ipad-dark@2x" src="https://github.com/user-attachments/assets/4b6a6161-ba47-4386-9687-b8b29aaa3025">
<img width="264" alt="build-logo-ipad-light@2x" src="https://github.com/user-attachments/assets/a6a116de-be5f-4653-a347-e8553abc83ab">
![lock-locked@2x](https://github.com/user-attachments/assets/14300d44-a11c-4912-b7a3-6c9c89b55667)
![build-logo-ipad-dark](https://github.com/user-attachments/assets/5a6d7797-8605-4f15-8899-4b2ff5e35125)
![iPad-Spotlight-40pt](https://github.com/user-attachments/assets/4cd207db-4326-4bb5-8aa3-7ddb71acc470)
![IMG_A2C8A087D26C-1](https://github.com/user-attachments/assets/d716ee53-d1bc-4d6b-a409-8dc910aab529)
![iPhone-App-60pt@2x](https://github.com/user-attachments/assets/fa90cbc6-68ba-4dcf-94b2-93ca5b47b2f7)
![App-Store-iOS-1024pt](https://github.com/user-attachments/assets/16d2c21a-9345-4560-9ea0-8875bc25adf4)
![lock-locked](https://github.com/user-attachments/assets/6191ab39-09bd-46ce-9c7c-301cfa99319a)
![iPad-Spotlight-40pt@2x](https://github.com/user-attachments/assets/fd341122-2711-43ca-a1f4-dd3b02f47285)
![build-logo-iphone-dark](https://github.com/user-attachments/assets/81368a9d-f29a-4b77-a05b-04d668903309)
![build-logo-iphone-dark@3x](https://github.com/user-attachments/assets/18550153-97d0-4179-a0b2-96f9554fac46)
<img width="163" alt="build-logo-iphone-dark@2x" src="https://github.com/user-attachments/assets/7774f932-7622-4f3f-984f-8fdb0608d48f">


The only required configuration is an admin password and a wireguard private key. The admin
password can be anything you like. You can generate a wireguard private key by
[following the official docs](https://www.wireguard.com/quickstart/#key-generation).

TLDR:

```bash
wg genkey
```

The config file format is `yaml` and an example is provided [below](#the-config-file-configyaml).

Here's what you can configure:

| Environment Variable       | CLI Flag                   | Config File Path       | Required | Default (docker)                        | Description                                                                                                                                                                                 |
| -------------------------- | -------------------------- | ---------------------- | -------- | --------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `WG_CONFIG`                | `--config`                 |                        |          |                                         | The path to a wg-access-server config.yaml file                                                                                                                                             |
| `WG_LOG_LEVEL`             | `--log-level`              | `logLevel`             |          | `info`                                  | The global log level                                                                                                                                                                        |
| `WG_ADMIN_USERNAME`        | `--admin-username`         | `adminUsername`        |          | `admin`                                 | The admin account username                                                                                                                                                                  |
| `WG_ADMIN_PASSWORD`        | `--admin-password`         | `adminPassword`        | Yes      |                                         | The admin account password                                                                                                                                                                  |
| `WG_PORT`                  | `--port`                   | `port`                 |          | `8000`                                  | The port the web ui will listen on (http)                                                                                                                                                   |
| `WG_EXTERNAL_HOST`         | `--external-host`          | `externalHost`         |          |                                         | The external domain for the server (e.g. https://www.mydomain.com)                                                                                                                          |
| `WG_STORAGE`               | `--storage`                | `storage`              |          | `sqlite3:///data/db.sqlite3`            | A storage backend connection string. See [storage docs](./3-storage.md)                                                                                                                     |
| `WG_DISABLE_METADATA`      | `--disable-metadata`       | `disableMetadata`      |          | `false`                                 | Turn off collection of device metadata logging. Includes last handshake time and RX/TX bytes only.                                                                                          |
| `WG_WIREGUARD_ENABLED`     | `--[no-]wireguard-enabled` | `wireguard.enabled`    |          | `true`                                  | Enable/disable the wireguard server. Useful for development on non-linux machines.                                                                                                          |
| `WG_WIREGUARD_INTERFACE`   | `--wireguard-interface`    | `wireguard.interface`  |          | `wg0`                                   | The wireguard network interface name                                                                                                                                                        |
| `WG_WIREGUARD_PRIVATE_KEY` | `--wireguard-private-key`  | `wireguard.privateKey` | Yes      |                                         | The wireguard private key. This value is required and must be stable. If this value changes all devices must re-register.                                                                   |
| `WG_WIREGUARD_PORT`        | `--wireguard-port`         | `wireguard.port`       |          | `51820`                                 | The wireguard server port (udp)                                                                                                                                                             |
| `WG_VPN_CIDR`              | `--vpn-cidr`               | `vpn.cidr`             |          | `10.44.0.0/24`                          | The VPN network range. VPN clients will be assigned IP addresses in this range.                                                                                                             |
| `WG_VPN_GATEWAY_INTERFACE` | `--vpn-gateway-interface`  | `vpn.gatewayInterface` |          | _default gateway interface (e.g. eth0)_ | The VPN gateway interface. VPN client traffic will be forwarded to this interface.                                                                                                          |
| `WG_VPN_ALLOWED_IPS`       | `--vpn-allowed-ips`        | `vpn.allowedIPs`       |          | `0.0.0.0/0`                             | Allowed IPs that clients may route through this VPN. This will be set in the client's WireGuard connection file and routing is also enforced by the server using iptables.                  |
| `WG_DNS_ENABLED`           | `--[no-]dns-enabled`       | `dns.enabled`          |          | `true`                                  | Enable/disable the embedded DNS proxy server. This is enabled by default and allows VPN clients to avoid DNS leaks by sending all DNS requests to wg-access-server itself.                  |
| `WG_DNS_UPSTREAM`          | `--dns-upstream`           | `dns.upstream`         |          | _resolveconf autodetection or 1.1.1.1_  | The upstream DNS server to proxy DNS requests to. By default the host machine's resolveconf configuration is used to find it's upstream DNS server, otherwise 1.1.1.1 (cloudflare) is used. |

## The Config File (config.yaml)

Here's an example config file to get started with.

```yaml
loglevel: info
storage: sqlite3:///data/db.sqlite3
wireguard:
  privateKey: "<some-key>"
dns:
  upstream:
    - "8.8.8.8"
```
